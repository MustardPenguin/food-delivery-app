
# General config
server:
  port: ${PORT:8080}

spring:
  application:
    name: ecommerce-api-gateway

# Gateway config
spring.cloud:
  gateway:
    globalcors:
      cors-configurations:
        '[/**]':
          allowed-origins:
           - "*"
          allowed-headers:
           - "*"
          allowed-methods:
            - GET
            - POST
            - PUT
            - DELETE
    default-filters:
      - TokenRelay=
    routes:
      - id: order-command
        uri: ${ORDER_COMMAND_HOST:http://localhost:8181}
        predicates:
          - Path=/api/v1/orders/**
      - id: any
        uri: http://localhost:8181
        predicates:
          - Path=/**


# Security config
spring.security.oauth2:
  resourceserver:
    jwt:
      jwk-set-uri: ${JWK_SET_URI:http://localhost:9090/realms/food-delivery-app/protocol/openid-connect/certs}
  client:
    provider:
      keycloak:
        issuer-uri: ${ISSUER_URI:http://localhost:9090/realms/food-delivery-app}
    registration:
      api-gateway:
        provider: keycloak
        client-id: api-gateway
        client-secret: ${CLIENT_SECRET:bOGL4LdWXsQMKvU0obODwFTiua66kKf7}
        authorization-grant-type: authorization_code
        scope: openid